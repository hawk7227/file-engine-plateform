#!/usr/bin/env bash
# ╔══════════════════════════════════════════════════════════════════╗
# ║  VERCEL-PROOF™ Git Pre-Push Hook                              ║
# ║  Automatically runs verification before every push             ║
# ╚══════════════════════════════════════════════════════════════════╝
#
# INSTALL:
#   cp pre-push .git/hooks/pre-push
#   chmod +x .git/hooks/pre-push
#
# Or install with the setup script:
#   ./vercel-proof-setup.sh

echo ""
echo "╔══════════════════════════════════════════════════════════════╗"
echo "║  VERCEL-PROOF™ Pre-Push Verification                      ║"
echo "╚══════════════════════════════════════════════════════════════╝"
echo ""

# Run the verification script
if [[ -f "./vercel-proof.sh" ]]; then
  bash ./vercel-proof.sh
  exit_code=$?
elif [[ -f "./scripts/vercel-proof.sh" ]]; then
  bash ./scripts/vercel-proof.sh
  exit_code=$?
else
  echo "⚠ vercel-proof.sh not found — skipping verification"
  exit 0
fi

if [[ $exit_code -eq 1 ]]; then
  echo ""
  echo "╔══════════════════════════════════════════════════════════════╗"
  echo "║  ✗ PUSH BLOCKED — Fix errors before pushing               ║"
  echo "║  Run: ./vercel-proof.sh --fix  (for auto-fixes)            ║"
  echo "║  Run: git push --no-verify    (to skip — NOT recommended)  ║"
  echo "╚══════════════════════════════════════════════════════════════╝"
  exit 1
fi

exit 0
